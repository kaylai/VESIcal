

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculating and plotting degassing paths &mdash; VESIcal 1.2.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=77553476" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=010db75e"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">ChangeLog</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About VESIcal</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models in VESIcal</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Integration with Thermobar</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshops.html">Workshops and Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="codedoc.html">VESIcal Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ’s</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">MIT Licence</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">ChangeLog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VESIcal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Calculating and plotting degassing paths</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ex_degassing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="calculating-and-plotting-degassing-paths">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Calculating and plotting degassing paths</a><a class="headerlink" href="#calculating-and-plotting-degassing-paths" title="Link to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#calculating-and-plotting-degassing-paths" id="id1">Calculating and plotting degassing paths</a></p>
<ul>
<li><p><a class="reference internal" href="#calculate-degassing-paths" id="id2">Calculate degassing paths</a></p>
<ul>
<li><p><a class="reference internal" href="#import-a-data-file-and-extract-a-single-sample" id="id3">Import a data file and extract a single sample</a></p></li>
<li><p><a class="reference internal" href="#open-system-degassing-calculation" id="id4">Open system degassing calculation</a></p></li>
<li><p><a class="reference internal" href="#closed-system-degassing-calculation" id="id5">Closed system degassing calculation</a></p></li>
<li><p><a class="reference internal" href="#partially-closed-system-degassing-calculation" id="id6">Partially closed system degassing calculation</a></p></li>
<li><p><a class="reference internal" href="#closed-system-with-initial-fluid" id="id7">Closed system with initial fluid</a></p></li>
<li><p><a class="reference internal" href="#calculate-from-initial-pressure-below-saturation" id="id8">Calculate from initial pressure below saturation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#plotting-degassing-paths" id="id9">Plotting degassing paths</a></p>
<ul>
<li><p><a class="reference internal" href="#plotting-degassing-paths-from-saturation-pressure" id="id10">Plotting degassing paths from saturation pressure</a></p></li>
<li><p><a class="reference internal" href="#plotting-degassing-paths-from-2000-bars" id="id11">Plotting degassing paths from 2000 bars</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="calculate-degassing-paths">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Calculate degassing paths</a><a class="headerlink" href="#calculate-degassing-paths" title="Link to this heading"></a></h2>
<p>A degassing path is a series of volatile concentrations both in the liquid and fluid that a magma will follow during decompression. In the <code class="xref py py-meth docutils literal notranslate"><span class="pre">VESIcal.calculate_degassing_path()</span></code> calculation, the saturation pressure is computed, and then the system is equilibrated along a trajectory of decreasing pressure values at discrete steps. The default number of steps to calculate is 50, but this can be defined by the user by setting the argument steps to any integer value. If so desired, this calculation can be performed for any initial pressure, but the default is the saturation pressure. If a pressure is specified that is above the saturation pressure, the calculation will simlpy proceed from the saturation pressure, since the magma cannot degas until it reaches saturation.</p>
<p>Completely open-system, completely closed-system or partially open-system degassing paths can be calculated by specifying what proportion of the fluid to fractionate. The fluid fractionation value can range between 0 (closed-system: no fluid is removed, all is retained at each pressure step) and 1 (open-system: all fluid is removed, none is retained at each pressure step). Closed and partially open-system runs allow the user to speficy the initial presence of exsolved fluid that is in equilirium with the melt at the starting pressure.</p>
<p><strong>Method structure:</strong></p>
<p><em>Only single-sample calculations:</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_degassing_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span> <span class="n">fractionate_vapor</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">init_vapor</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
<p><strong>Required inputs:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">sample</span></code>: The composition of a sample. A single sample may be passed as a dictionary of values, with compositions of oxides in wt%.</p>
<p><code class="docutils literal notranslate"><span class="pre">temperature</span></code>: The temperature in degres C.</p>
<p><strong>Optional inputs:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">pressure</span></code>: The perssure at which to begin the degassing calculations, in bars. Default value is ‘saturation’, which runs the calculation with the initial pressure at the saturation pressure. If a pressure greater than the saturation pressure is input, the calculation will start at saturation, since this is the first pressure at which any degassing will occur.</p>
<p><code class="docutils literal notranslate"><span class="pre">fractionate_vapor</span></code>: Proportion of vapor removed at each pressure step. Default value is 0.0 (completely closed-system degassing). Specifies the type of calculation performed, either closed system (0.0) or open system (1.0) degassing. If any value between &lt;1.0 is chosen, user can also specify the ‘init_vapor’ argument (see below). A value in between 0 and 1 will remove that proportion of vapor at each step. For example, for a value of 0.2, the calculation will remove 20% of the vapor and retain 80% of the vapor at each pressure step.</p>
<p><code class="docutils literal notranslate"><span class="pre">init_vapor</span></code>: Default value is 0.0. Specifies the amount of vapor (in wt%) coexisting with the melt before degassing.</p>
<p><code class="docutils literal notranslate"><span class="pre">steps</span></code>: Default value is 50. Specifies the number of steps in pressure space at which to calcualte dissolved volatiles.</p>
<p><strong>Calculated outputs:</strong>
The function returns a pandas DataFrame with columns as: ‘Pressure_bars’, ‘H2O_liq’ and ‘CO2_liq’ (the concentration of H2O and CO2 in the liquid, in wt%), ‘XH2O_fl’ and ‘XCO2_fl’ (the composition of the H2O-CO2 fluid, in mol fraction), and ‘FluidProportion_wt’ (the proportion of fluid in the fluid-melt system, in wt%).</p>
<section id="import-a-data-file-and-extract-a-single-sample">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Import a data file and extract a single sample</a><a class="headerlink" href="#import-a-data-file-and-extract-a-single-sample" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myfile</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">BatchFile</span><span class="p">(</span><span class="s1">&#39;../manuscript/example_data.xlsx&#39;</span><span class="p">)</span>
<span class="n">SampleName</span> <span class="o">=</span> <span class="s1">&#39;BT-ex&#39;</span>
<span class="n">extracted_bulk_comp</span> <span class="o">=</span> <span class="n">myfile</span><span class="o">.</span><span class="n">get_sample_composition</span><span class="p">(</span><span class="n">SampleName</span><span class="p">,</span> <span class="n">asSampleClass</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="open-system-degassing-calculation">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Open system degassing calculation</a><a class="headerlink" href="#open-system-degassing-calculation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">open_df</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">calculate_degassing_path</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">extracted_bulk_comp</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">900.0</span><span class="p">,</span> <span class="n">fractionate_vapor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</section>
<section id="closed-system-degassing-calculation">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Closed system degassing calculation</a><a class="headerlink" href="#closed-system-degassing-calculation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">closed_df</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">calculate_degassing_path</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">extracted_bulk_comp</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">900.0</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</section>
<section id="partially-closed-system-degassing-calculation">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Partially closed system degassing calculation</a><a class="headerlink" href="#partially-closed-system-degassing-calculation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">half_df</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">calculate_degassing_path</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">extracted_bulk_comp</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">900.0</span><span class="p">,</span> <span class="n">fractionate_vapor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</section>
<section id="closed-system-with-initial-fluid">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Closed system with initial fluid</a><a class="headerlink" href="#closed-system-with-initial-fluid" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exsolved_df</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">calculate_degassing_path</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">extracted_bulk_comp</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">900.0</span><span class="p">,</span> <span class="n">init_vapor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</section>
<section id="calculate-from-initial-pressure-below-saturation">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Calculate from initial pressure below saturation</a><a class="headerlink" href="#calculate-from-initial-pressure-below-saturation" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start2000_df</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">calculate_degassing_path</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">extracted_bulk_comp</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">900.0</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</section>
</section>
<section id="plotting-degassing-paths">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Plotting degassing paths</a><a class="headerlink" href="#plotting-degassing-paths" title="Link to this heading"></a></h2>
<p>Once degassing paths are calcualted, they may be easily plotted using VESIcal’s built in <code class="xref py py-meth docutils literal notranslate"><span class="pre">VESIcal.plot_degassing_paths()</span></code> method. The user can plot multiple degassing paths on one plot. Optionally, labels in the plot legend can be specified.</p>
<p><strong>Method structure:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">isobars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">isopleths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">degassing_paths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_H2O</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_CO2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">isobar_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">isopleth_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">degassing_path_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Required inputs to plot degassing paths:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">degassing_paths</span></code>: A list of DataFrames with degassing information as generated by calculate_degassing_path().</p>
<p><strong>Optional inputs:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">labels</span></code>: Labels for the plot legend. Default is None, in which case each plotted line will be given the generic legend name of “Pathn”, with n referring to the nth degassing path passed. The user can pass their own labels as a list of strings.</p>
<p><strong>Calculated outputs:</strong>
The function returns a matplotlib object with the x-axis as H2O, wt% and the y-axis as CO2, wt%. All degassing paths passed are plotted on one figure.</p>
<section id="plotting-degassing-paths-from-saturation-pressure">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Plotting degassing paths from saturation pressure</a><a class="headerlink" href="#plotting-degassing-paths-from-saturation-pressure" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">degassing_paths</span><span class="o">=</span><span class="p">[</span><span class="n">open_df</span><span class="p">,</span> <span class="n">half_df</span><span class="p">,</span> <span class="n">closed_df</span><span class="p">,</span> <span class="n">exsolved_df</span><span class="p">],</span>
       <span class="n">degassing_path_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Open&quot;</span><span class="p">,</span> <span class="s2">&quot;Half&quot;</span><span class="p">,</span> <span class="s2">&quot;Closed&quot;</span><span class="p">,</span> <span class="s2">&quot;Exsolved&quot;</span><span class="p">])</span>
<span class="n">v</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/ex_degassing_img1.png"><img alt="_images/ex_degassing_img1.png" src="_images/ex_degassing_img1.png" style="width: 500px;" />
</a>
</section>
<section id="plotting-degassing-paths-from-2000-bars">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Plotting degassing paths from 2000 bars</a><a class="headerlink" href="#plotting-degassing-paths-from-2000-bars" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">degassing_paths</span><span class="o">=</span><span class="p">[</span><span class="n">start2000_df</span><span class="p">],</span> <span class="n">degassing_path_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2000 bars&quot;</span><span class="p">])</span>
<span class="n">v</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/ex_degassing_img2.png"><img alt="_images/ex_degassing_img2.png" src="_images/ex_degassing_img2.png" style="width: 500px;" />
</a>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Kayla Iacovino and Simon Matthews.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>