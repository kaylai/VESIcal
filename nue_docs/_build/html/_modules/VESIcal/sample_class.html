<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VESIcal.sample_class &mdash; VESIcal 1.2.6 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">ChangeLog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About VESIcal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">Models in VESIcal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_tutorials.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Verbose Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_tutorials.html">Advanced Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../youtube.html">YouTube Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integration.html">Integration with Thermobar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workshops.html">Workshops and Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../codedoc.html">VESIcal Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQâ€™s</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">MIT Licence</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">VESIcal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
          <li><a href="../VESIcal.html">VESIcal</a> &raquo;</li>
      <li>VESIcal.sample_class</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for VESIcal.sample_class</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span> <span class="k">as</span> <span class="nn">w</span>

<span class="kn">from</span> <span class="nn">VESIcal</span> <span class="kn">import</span> <span class="n">core</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span><span class="p">,</span> <span class="n">copy</span>


<div class="viewcode-block" id="Sample"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample">[docs]</a><span class="k">class</span> <span class="nc">Sample</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; The sample class stores compositional information for samples, and contains methods for</span>
<span class="sd">    normalization and other compositional calculations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">,</span> <span class="n">default_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                 <span class="n">default_units</span><span class="o">=</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initialises the sample class.</span>

<span class="sd">        The composition is stored as wtpt. If the composition is provided as wtpt, no</span>
<span class="sd">        normalization will be applied. If the composition is supplied as mols, the composition</span>
<span class="sd">        will be normalized to 100 wt%.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition     dict or pandas.Series</span>
<span class="sd">            The composition of the sample in the format specified by the composition_type</span>
<span class="sd">            parameter. Default is oxides in wtpt.</span>

<span class="sd">        units     str</span>
<span class="sd">            Specifies the units and type of compositional information passed in the composition</span>
<span class="sd">            parameter. Choose from &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, &#39;mol_cations&#39;.</span>

<span class="sd">        default_normalization:     None or str</span>
<span class="sd">            The type of normalization to apply to the data by default. One of:</span>
<span class="sd">                - None (no normalization)</span>
<span class="sd">                - &#39;standard&#39; (default): Normalizes an input composition to 100%.</span>
<span class="sd">                - &#39;fixedvolatiles&#39;: Normalizes major element oxides to 100 wt%, including</span>
<span class="sd">                  volatiles. The volatile wt% will remain fixed, whilst the other major element</span>
<span class="sd">                  oxides are reduced proportionally so that the total is 100 wt%.</span>
<span class="sd">                - &#39;additionalvolatiles&#39;: Normalises major element oxide wt% to 100%, assuming it</span>
<span class="sd">                  is volatile-free. If H2O or CO2 are passed to the function, their un-normalized</span>
<span class="sd">                  values will be retained in addition to the normalized non-volatile oxides,</span>
<span class="sd">                  summing to &gt;100%.</span>

<span class="sd">        default_units     str</span>
<span class="sd">            The type of composition to return by default, one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>
<span class="sd">            - mol_singleO</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">composition</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">composition</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">composition</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;The composition must be given as either a dictionary or a &quot;</span>
                                  <span class="s2">&quot;pandas Series.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span> <span class="o">=</span> <span class="n">composition</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_oxides&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_molOxides_to_wtpercentOxides</span><span class="p">(</span><span class="n">composition</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_molCations_to_wtpercentOxides</span><span class="p">(</span><span class="n">composition</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;Units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, or &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_default_normalization</span><span class="p">(</span><span class="n">default_normalization</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_default_units</span><span class="p">(</span><span class="n">default_units</span><span class="p">)</span>

        <span class="c1"># handle possibly passed FeOT values, convert to FeO and warn user</span>
        <span class="n">possible_FeOT_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FeOT&#39;</span><span class="p">,</span> <span class="s1">&#39;FeO*&#39;</span><span class="p">,</span> <span class="s1">&#39;FeOtot&#39;</span><span class="p">,</span> <span class="s1">&#39;FeOt&#39;</span><span class="p">,</span> <span class="s1">&#39;FeOtotal&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;FeOstar&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">possible_FeOT_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">composition</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;FeO&#39;</span> <span class="ow">in</span> <span class="n">composition</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;FeO and &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; oxides passed. Discarding &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span>
                           <span class="s2">&quot; oxide.&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="k">del</span> <span class="n">composition</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                        <span class="n">composition</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; oxide found. Using &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; for FeO value.&quot;</span><span class="p">,</span>
                           <span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">composition</span><span class="p">[</span><span class="s1">&#39;FeO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">composition</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="k">del</span> <span class="n">composition</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                        <span class="n">composition</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="Sample.set_default_normalization"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.set_default_normalization">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_normalization</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set the default type of normalization to use with the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        default_normalization:    str</span>
<span class="sd">            The type of normalization to apply to the data. One of:</span>
<span class="sd">            - &#39;none&#39; (no normalization)</span>
<span class="sd">            - &#39;standard&#39; (default): Normalizes an input composition to 100%.</span>
<span class="sd">            - &#39;fixedvolatiles&#39;: Normalizes major element oxides to 100 wt%, including volatiles.</span>
<span class="sd">              The volatile wt% will remain fixed, whilst the other major element oxides are</span>
<span class="sd">              reduced proportionally so that the total is 100 wt%.</span>
<span class="sd">            - &#39;additionalvolatiles&#39;: Normalises major element oxide wt% to 100%, assuming it is</span>
<span class="sd">              volatile-free. If H2O or CO2 are passed to the function, their un-normalized values</span>
<span class="sd">              will be retained in addition to the normalized non-volatile oxides, summing to &gt;100%.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">default_normalization</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="s1">&#39;fixedvolatiles&#39;</span><span class="p">,</span> <span class="s1">&#39;additionalvolatiles&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_normalization</span> <span class="o">=</span> <span class="n">default_normalization</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;The normalization method must be one of &#39;none&#39;, &#39;standard&#39;, &quot;</span>
                                  <span class="s2">&quot;&#39;fixedvolatiles&#39;, or &#39;additionalvolatiles&#39;.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sample.set_default_units"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.set_default_units">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_units</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set the default units of composition to return when using the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        default_units     str</span>
<span class="sd">            The type of composition to return, one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>
<span class="sd">            - mol_singleO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">default_units</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_oxides&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_singleO&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span> <span class="o">=</span> <span class="n">default_units</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;The units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;, or &#39;mol_singleO&#39;.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sample.get_composition"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.get_composition">[docs]</a>    <span class="k">def</span> <span class="nf">get_composition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">exclude_volatiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">asSampleClass</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">oxide_masses</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot; Returns the composition in the format requested, normalized as requested.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        species:    NoneType or str</span>
<span class="sd">            The name of the oxide or cation to return the concentration of. If NoneType (default)</span>
<span class="sd">            the whole composition will be returned as a pandas.Series. If an oxide is passed, the</span>
<span class="sd">            value in wtpt will be returned unless units is set to &#39;mol_oxides&#39;, even if the</span>
<span class="sd">            default units for the sample object are mol_oxides. If an element is passed, the</span>
<span class="sd">            concentration will be returned as mol_cations, unless &#39;mol_singleO&#39; is specified as</span>
<span class="sd">            units, even if the default units for the sample object are mol_singleO. Unless</span>
<span class="sd">            normalization is specified in the method call, none will be applied.</span>

<span class="sd">        normalization:     NoneType or str</span>
<span class="sd">            The type of normalization to apply to the data. One of:</span>
<span class="sd">            - &#39;none&#39; (no normalization)</span>
<span class="sd">            - &#39;standard&#39; (default): Normalizes an input composition to 100%.</span>
<span class="sd">            - &#39;fixedvolatiles&#39;: Normalizes major element oxides to 100 wt%, including volatiles.</span>
<span class="sd">              The volatile wt% will remain fixed, whilst the other major element oxides are reduced</span>
<span class="sd">              proportionally so that the total is 100 wt%.</span>
<span class="sd">            - &#39;additionalvolatiles&#39;: Normalises major element oxide wt% to 100%, assuming it is</span>
<span class="sd">              volatile-free. If H2O or CO2 are passed to the function, their un-normalized values</span>
<span class="sd">              will be retained in addition to the normalized non-volatile oxides, summing to &gt;100%.</span>
<span class="sd">            If NoneType is passed the default normalization option will be used</span>
<span class="sd">            (self.default_normalization).</span>

<span class="sd">        units:     NoneType or str</span>
<span class="sd">            The units of composition to return, one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>
<span class="sd">            - mol_singleO</span>
<span class="sd">            If NoneType is passed the default units option will be used (self.default_type).</span>

<span class="sd">        exclude_volatiles   bool</span>
<span class="sd">            If True, volatiles will be excluded from the returned composition, prior to</span>
<span class="sd">            normalization and conversion.</span>

<span class="sd">        asSampleClass:  bool</span>
<span class="sd">            If True, the sample composition will be returned as a sample class, with default</span>
<span class="sd">            options. In this case any normalization instructions will be ignored.</span>

<span class="sd">        oxide_masses:  dict</span>
<span class="sd">            Specify here any oxide masses that should be changed from the VESIcal default. This</span>
<span class="sd">            might be useful for recreating other implementations of models that use slightly</span>
<span class="sd">            different molecular masses. The default values in VESIcal are given to 3 dp.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series, float, or Sample class</span>
<span class="sd">            The sample composition, as specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Process the oxide_masses variable, if necessary:</span>
        <span class="n">oxideMass</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">oxideMass</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">oxide_masses</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">oxideMass</span><span class="p">:</span>
                <span class="n">oxideMass</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">oxide_masses</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;The oxide name provided in oxide_masses is not recognised.&quot;</span><span class="p">)</span>

        <span class="c1"># Fetch the default return types if not specified in function call</span>
        <span class="k">if</span> <span class="n">normalization</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">species</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">normalization</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_normalization</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">species</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span>

        <span class="c1"># Check whether to exclude volatiles</span>
        <span class="c1"># note that here composition is gotten as wtpt_oxides</span>
        <span class="k">if</span> <span class="n">exclude_volatiles</span><span class="p">:</span>
            <span class="n">composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;H2O&#39;</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="n">composition</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;H2O&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;CO2&#39;</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="n">composition</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;CO2&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Check for a species being provided, if so, work out which units to return.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">oxides</span><span class="p">:</span>
                <span class="n">corresponding_cation</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">oxides_to_cations</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">corresponding_cation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">species</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Species &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">species</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; not found in composition,&quot;</span> <span class="o">+</span>
                               <span class="s2">&quot; assigning value of 0.0&quot;</span><span class="p">,</span>
                               <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mf">0.0</span>
                <span class="k">if</span> <span class="n">units</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mol_cations&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_singleO&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">units</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mol_cations&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_singleO&#39;</span><span class="p">]:</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Given species is an oxide. Concentration will be returned in&quot;</span> <span class="o">+</span>
                               <span class="s2">&quot; units of wtpt_oxides.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;wtpt_oxides&#39;</span>
            <span class="k">elif</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">cations</span><span class="p">:</span>
                <span class="n">corresponding_oxide</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">corresponding_oxide</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">species</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Species not found in composition, assigning value of 0.0&quot;</span><span class="p">,</span>
                               <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mf">0.0</span>
                <span class="k">if</span> <span class="n">units</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_oxides&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">units</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">,</span> <span class="s1">&#39;mol_oxides&#39;</span><span class="p">]:</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Given species is a cation. Concentration will be returned in&quot;</span> <span class="o">+</span>
                               <span class="s2">&quot; units of mol_cations.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mol_cations&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="n">species</span> <span class="o">+</span> <span class="s2">&quot; was not recognised, check spelling, &quot;</span> <span class="o">+</span>
                                      <span class="s2">&quot;capitalization and stoichiometry.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">species</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Species must be either a string or a NoneType.&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
                         <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">normalization</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">normalization</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>

        <span class="c1"># Get the requested type of composition</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">:</span>
            <span class="n">converted</span> <span class="o">=</span> <span class="n">composition</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_oxides&#39;</span><span class="p">:</span>
            <span class="n">converted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wtpercentOxides_to_molOxides</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">oxideMass</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">:</span>
            <span class="n">converted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wtpercentOxides_to_molCations</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">oxideMass</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_singleO&#39;</span><span class="p">:</span>
            <span class="n">converted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wtpercentOxides_to_molSingleO</span><span class="p">(</span><span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">oxideMass</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;The units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;, or &#39;mol_singleO&#39;.&quot;</span><span class="p">)</span>

        <span class="c1"># Do requested normalization</span>
        <span class="k">if</span> <span class="n">normalization</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">final</span> <span class="o">=</span> <span class="n">converted</span>
        <span class="k">elif</span> <span class="n">normalization</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
            <span class="n">final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_Standard</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">normalization</span> <span class="o">==</span> <span class="s1">&#39;fixedvolatiles&#39;</span><span class="p">:</span>
            <span class="n">final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_FixedVolatiles</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">normalization</span> <span class="o">==</span> <span class="s1">&#39;additionalvolatiles&#39;</span><span class="p">:</span>
            <span class="n">final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_AdditionalVolatiles</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;The normalization method must be one of &#39;none&#39;, &#39;standard&#39;, &quot;</span>
                                  <span class="s2">&quot;&#39;fixedvolatiles&#39;, or &#39;additionalvolatiles&#39;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">species</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">asSampleClass</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">final</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Sample</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">asSampleClass</span><span class="p">:</span>
                <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Cannot return single species as Sample class. Returning as float.&quot;</span><span class="p">,</span>
                       <span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">final</span><span class="p">[</span><span class="n">species</span><span class="p">]</span></div>

<div class="viewcode-block" id="Sample.change_composition"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.change_composition">[docs]</a>    <span class="k">def</span> <span class="nf">change_composition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_composition</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the concentration of some component of the composition.</span>

<span class="sd">        If the units are moles, they are read as moles relative to the present composition,</span>
<span class="sd">        i.e. if you wish to double the moles of MgO, if the present content is 0.1 moles,</span>
<span class="sd">        you should provide {&#39;MgO&#39;:0.2}. The composition will then be re-normalized. If the</span>
<span class="sd">        original composition was provided in un-normalized wt%, the unnormalized total will</span>
<span class="sd">        be lost.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_composition:    dict or pandas.Series</span>
<span class="sd">            The components to be updated.</span>
<span class="sd">        units:      str</span>
<span class="sd">            The units of new_composition. Should be one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>
<span class="sd">        inplace:    bool</span>
<span class="sd">            If True the object will be modified in place. If False, a copy of the Sample</span>
<span class="sd">            object will be created, modified, and then returned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Sample class</span>
<span class="sd">            Modified Sample class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># if new_composition is pandas.Series, convert to dict</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_composition</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">new_composition</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">new_composition</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">newsample</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">newsample</span><span class="o">.</span><span class="n">change_composition</span><span class="p">(</span><span class="n">new_composition</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">new_composition</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_composition</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_oxides&#39;</span><span class="p">:</span>
            <span class="n">_comp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_composition</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;mol_oxides&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">new_composition</span><span class="p">:</span>
                <span class="n">_comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_composition</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_molOxides_to_wtpercentOxides</span><span class="p">(</span><span class="n">_comp</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">:</span>
            <span class="n">_comp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_composition</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;mol_cations&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">new_composition</span><span class="p">:</span>
                <span class="n">_comp</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_composition</span><span class="p">[</span><span class="n">el</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_molCations_to_wtpercentOxides</span><span class="p">(</span><span class="n">_comp</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;Units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, or &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Sample.delete_oxide"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.delete_oxide">[docs]</a>    <span class="k">def</span> <span class="nf">delete_oxide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oxide</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Allows user to remove a given oxide from the Sample composition</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oxide:  str or list</span>
<span class="sd">            Name or names of the oxide(s) to remove.</span>

<span class="sd">        inplace:    bool</span>
<span class="sd">            If True the object will be modified in place. If False, a copy of the Sample</span>
<span class="sd">            object will be created, modified, and then returned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Sample class</span>
<span class="sd">            Modified Sample class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if new_composition is pandas.Series, convert to dict</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">oxide</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">oxide</span> <span class="o">=</span> <span class="p">[</span><span class="n">oxide</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">newsample</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">newsample</span><span class="o">.</span><span class="n">delete_oxide</span><span class="p">(</span><span class="n">oxide</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">oxide</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Sample.get_formulaweight"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.get_formulaweight">[docs]</a>    <span class="k">def</span> <span class="nf">get_formulaweight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude_volatiles</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Converts major element oxides in wt% to the formula weight (on a 1 oxygen basis).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exclude_volatiles   bool</span>
<span class="sd">            If True the formula weight will be calculated without volatiles</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The formula weight of the composition, on a one oxygen basis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_composition</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;mol_singleO&#39;</span><span class="p">,</span>
                                       <span class="n">exclude_volatiles</span><span class="o">=</span><span class="n">exclude_volatiles</span><span class="p">)</span>

        <span class="n">FW</span> <span class="o">=</span> <span class="mf">15.999</span>
        <span class="k">for</span> <span class="n">cation</span> <span class="ow">in</span> <span class="n">cations</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">FW</span> <span class="o">+=</span> <span class="n">cations</span><span class="p">[</span><span class="n">cation</span><span class="p">]</span><span class="o">*</span><span class="n">core</span><span class="o">.</span><span class="n">CationMass</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">cation</span><span class="p">]]</span>

        <span class="k">return</span> <span class="n">FW</span></div>

<div class="viewcode-block" id="Sample.check_oxide"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.check_oxide">[docs]</a>    <span class="k">def</span> <span class="nf">check_oxide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oxide</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the sample composition contains the given oxide.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oxide:  str</span>
<span class="sd">            Oxide name to check composition for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether the composition contains the given oxide, or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">oxide</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">oxides</span><span class="p">:</span>
            <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Oxide name not recognised. If it is in your sample, unexpected behaviour &quot;</span>
                   <span class="s2">&quot;might occur!&quot;</span><span class="p">,</span>
                   <span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">oxide</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_composition</span></div>

<div class="viewcode-block" id="Sample.check_cation"><a class="viewcode-back" href="../../codedoc.html#VESIcal.sample_class.Sample.check_cation">[docs]</a>    <span class="k">def</span> <span class="nf">check_cation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the sample composition contains the given cation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cation:    str</span>
<span class="sd">            The element name to check the composition for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether the composition contains the given element, or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">cation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">:</span>
            <span class="n">w</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Cation name not recognised. If it is in your sample, unexpected behaviour &quot;</span>
                   <span class="s2">&quot;might occur!&quot;</span><span class="p">,</span>
                   <span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_composition</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;mol_cations&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_normalize_Standard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalizes the given composition to 100 wt%, including volatiles. This method</span>
<span class="sd">        is intended only to be called by the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas.Series</span>
<span class="sd">            A rock composition with oxide names as keys and concentrations as values.</span>

<span class="sd">        units:      str</span>
<span class="sd">            The units of composition. Should be one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            Normalized oxides in wt%.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">:</span>
            <span class="n">normed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_oxides&#39;</span> <span class="ow">or</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">:</span>
            <span class="n">normed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;Units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, or &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">normed</span>

    <span class="k">def</span> <span class="nf">_normalize_FixedVolatiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalizes major element oxides to 100 wt%, including volatiles. The volatile wt% will</span>
<span class="sd">        remain fixed, whilst the other major element oxides are reduced proportionally so that the</span>
<span class="sd">        total is 100 wt%.</span>

<span class="sd">        Intended to be called only by the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas Series</span>
<span class="sd">            Major element composition</span>

<span class="sd">        units:      str</span>
<span class="sd">            The units of composition. Should be one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas Series</span>
<span class="sd">            Normalized major element oxides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">volatiles</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s1">&#39;CO2&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">volatiles</span> <span class="o">+=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;H2O&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">volatiles</span> <span class="o">+=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ox</span> <span class="o">!=</span> <span class="s1">&#39;H2O&#39;</span> <span class="ow">and</span> <span class="n">ox</span> <span class="o">!=</span> <span class="s1">&#39;CO2&#39;</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">:</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="n">normalized</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">volatiles</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_oxides&#39;</span> <span class="ow">or</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">:</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="n">normalized</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">volatiles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;Units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, or &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;CO2&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">normalized</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;H2O&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">normalized</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">normalized</span>

    <span class="k">def</span> <span class="nf">_normalize_AdditionalVolatiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalises major element oxide wt% to 100%, assuming it is volatile-free. If H2O or CO2</span>
<span class="sd">        are passed to the function, their un-normalized values will be retained in addition to the</span>
<span class="sd">        normalized non-volatile oxides, summing to &gt;100%.</span>

<span class="sd">        Intended to be called only by the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas.Series</span>
<span class="sd">            Major element composition</span>

<span class="sd">        units:      str</span>
<span class="sd">            The units of composition. Should be one of:</span>
<span class="sd">            - wtpt_oxides (default)</span>
<span class="sd">            - mol_oxides</span>
<span class="sd">            - mol_cations</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            Normalized major element oxides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ox</span> <span class="o">!=</span> <span class="s1">&#39;H2O&#39;</span> <span class="ow">and</span> <span class="n">ox</span> <span class="o">!=</span> <span class="s1">&#39;CO2&#39;</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;wtpt_oxides&#39;</span><span class="p">:</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="n">normalized</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
        <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_oxides&#39;</span> <span class="ow">or</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;mol_cations&#39;</span><span class="p">:</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="n">normalized</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">core</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s2">&quot;Units must be one of &#39;wtpt_oxides&#39;, &#39;mol_oxides&#39;, or &quot;</span>
                                  <span class="s2">&quot;&#39;mol_cations&#39;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;H2O&#39;</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">normalized</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;CO2&#39;</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">normalized</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">normalized</span>

    <span class="k">def</span> <span class="nf">_wtpercentOxides_to_molOxides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">oxideMass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a wt% oxide composition to mol oxides, normalised to 1 mol.</span>

<span class="sd">        Intended to be called only by the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:    pandas.Series</span>
<span class="sd">            Major element oxides in wt%</span>

<span class="sd">        oxideMass:  dict</span>
<span class="sd">            The molar mass of the oxides. Default is the VESIcal default molar masses.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            Molar proportions of major element oxides, normalised to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">molOxides</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">oxideslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">oxideslist</span><span class="p">:</span>
            <span class="n">molOxides</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">/</span><span class="n">oxideMass</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="n">molOxides</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">molOxides</span><span class="p">)</span>
        <span class="n">molOxides</span> <span class="o">=</span> <span class="n">molOxides</span><span class="o">/</span><span class="n">molOxides</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">molOxides</span>

    <span class="k">def</span> <span class="nf">_wtpercentOxides_to_molCations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">oxideMass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a wt% oxide composition to molar proportions of cations (normalised to 1).</span>

<span class="sd">        Intended to be called only by the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition        pandas.Series</span>
<span class="sd">            Major element oxides in wt%.</span>

<span class="sd">        oxideMass:  dict</span>
<span class="sd">            The molar mass of the oxides. Default is the VESIcal default molar masses.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            Molar proportions of cations, normalised to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">molCations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">oxideslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">oxideslist</span><span class="p">:</span>
            <span class="n">cation</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">oxides_to_cations</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>
            <span class="n">molCations</span><span class="p">[</span><span class="n">cation</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">CationNum</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">*</span><span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">/</span><span class="n">oxideMass</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="n">molCations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">molCations</span><span class="p">)</span>
        <span class="n">molCations</span> <span class="o">=</span> <span class="n">molCations</span><span class="o">/</span><span class="n">molCations</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">molCations</span>

    <span class="k">def</span> <span class="nf">_wtpercentOxides_to_molSingleO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">oxideMass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs the chemical formula, on a single oxygen basis, from wt% oxides.</span>

<span class="sd">        Intended to be called only by the get_composition() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition        pandas.Series</span>
<span class="sd">            Major element oxides in wt%</span>

<span class="sd">        oxideMass:  dict</span>
<span class="sd">            The molar mass of the oxides. Default is the VESIcal default molar masses.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            The chemical formula of the composition, on a single oxygen basis. Each element is</span>
<span class="sd">            a separate entry in the Series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">molCations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">oxideslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="n">total_O</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">oxideslist</span><span class="p">:</span>
            <span class="n">cation</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">oxides_to_cations</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>
            <span class="n">molCations</span><span class="p">[</span><span class="n">cation</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">CationNum</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">*</span><span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">/</span><span class="n">oxideMass</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>
            <span class="n">total_O</span> <span class="o">+=</span> <span class="n">core</span><span class="o">.</span><span class="n">OxygenNum</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">*</span><span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">/</span><span class="n">oxideMass</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="n">molCations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">molCations</span><span class="p">)</span>
        <span class="n">molCations</span> <span class="o">=</span> <span class="n">molCations</span><span class="o">/</span><span class="n">total_O</span>

        <span class="k">return</span> <span class="n">molCations</span>

    <span class="k">def</span> <span class="nf">_molOxides_to_wtpercentOxides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">oxideMass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts mol oxides to wt% oxides. Returned composition is normalized to 100 wt%.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas.Series</span>
<span class="sd">            mol fraction oxides</span>

<span class="sd">        oxideMass:  dict</span>
<span class="sd">            The molar mass of the oxides. Default is the VESIcal default molar masses.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            wt% oxides normalized to 100 wt%.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">wtpt</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">composition</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">wtpt</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">*</span><span class="n">oxideMass</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="n">wtpt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">wtpt</span><span class="p">)</span>
        <span class="n">wtpt</span> <span class="o">=</span> <span class="n">wtpt</span><span class="o">/</span><span class="n">wtpt</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>

        <span class="k">return</span> <span class="n">wtpt</span>

    <span class="k">def</span> <span class="nf">_molOxides_to_molCations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts mol oxides to mol cations. Returned composition is normalized to 1 mol</span>
<span class="sd">        cations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas.Series</span>
<span class="sd">            mole fraction oxides</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            mole fraction cations</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">molcations</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">ox</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">molcations</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">oxides_to_cations</span><span class="p">[</span><span class="n">ox</span><span class="p">]]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span><span class="o">*</span><span class="n">core</span><span class="o">.</span><span class="n">CationNum</span><span class="p">[</span><span class="n">ox</span><span class="p">]</span>

        <span class="n">molcations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">molcations</span><span class="p">)</span>
        <span class="n">molcations</span> <span class="o">=</span> <span class="n">molcations</span><span class="o">/</span><span class="n">molcations</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">molcations</span>

    <span class="k">def</span> <span class="nf">_molCations_to_wtpercentOxides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">,</span> <span class="n">oxideMass</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">oxideMass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts mole fraction cations to wt% oxides, normalized to 100 wt%.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas.Series</span>
<span class="sd">            Mole fraction cations</span>

<span class="sd">        oxideMass:  dict</span>
<span class="sd">            The molar mass of the oxides. Default is the VESIcal default molar masses.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            Wt% oxides, normalized to 100 wt%.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">wtpt</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">wtpt</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">el</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">comp</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">/</span> <span class="n">core</span><span class="o">.</span><span class="n">CationNum</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">el</span><span class="p">]]</span> <span class="o">*</span>
                <span class="n">oxideMass</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">el</span><span class="p">]])</span>

        <span class="n">wtpt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">wtpt</span><span class="p">)</span>
        <span class="n">wtpt</span> <span class="o">=</span> <span class="n">wtpt</span><span class="o">/</span><span class="n">wtpt</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>

        <span class="k">return</span> <span class="n">wtpt</span>

    <span class="k">def</span> <span class="nf">_molCations_to_molOxides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">composition</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts mole fraction cations to mole fraction oxides, normalized to 1 mole.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        composition:     pandas.Series</span>
<span class="sd">            Mole fraction cations</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>
<span class="sd">            Mole fraction oxides, normalized to one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">composition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">moloxides</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">moloxides</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">el</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">comp</span><span class="p">[</span><span class="n">el</span><span class="p">]</span><span class="o">/</span><span class="n">core</span><span class="o">.</span><span class="n">CationNum</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">cations_to_oxides</span><span class="p">[</span><span class="n">el</span><span class="p">]])</span>

        <span class="n">moloxides</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">moloxides</span><span class="p">)</span>
        <span class="n">moloxides</span> <span class="o">=</span> <span class="n">moloxides</span><span class="o">/</span><span class="n">moloxides</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">moloxides</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Kayla Iacovino and Simon Matthews.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>